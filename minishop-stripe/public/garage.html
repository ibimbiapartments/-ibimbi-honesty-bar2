<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>I Bimbi ‚Ä¢ Parcheggio & Deposito</title>
  <link rel="icon" href="/logo2.svg" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root {
      --bg:#f7f8fa; --card:#ffffff; --text:#1b1e23; --muted:#6b7280; --border:#e0e4ea;
      --primary:#1e90ff; --primary-hover:#1879da;
      --success:#00b894; --success-hover:#029d7f;
      --radius:20px; --shadow:0 6px 25px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:"Segoe UI",Roboto,system-ui,-apple-system,sans-serif;
      background:var(--bg);color:var(--text);
      min-height:100vh;display:flex;align-items:center;justify-content:center;
      padding:30px;
    }
    .wrap{width:100%;max-width:700px}
    .card{
      background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
      box-shadow:var(--shadow);padding:40px 28px 34px;text-align:center;position:relative;
    }
    .langswitch{
      position:absolute;top:16px;right:16px;display:flex;gap:6px;
    }
    .langswitch button{
      border:1px solid var(--border);background:#eef2f6;
      border-radius:10px;padding:5px 10px;cursor:pointer;font-weight:600;
      font-size:13px;color:#333;transition:all .2s ease;
    }
    .langswitch button.active{
      background:#dbeafe;border-color:#bfdbfe;color:#0b63d1;
    }
    .logo{
      display:block;margin:12px auto 28px;
      width:clamp(180px,22vw,260px);height:auto;max-width:100%;
    }
    h1{font-size:26px;margin-bottom:8px}
    p.lead{color:var(--muted);margin:0 auto 24px;line-height:1.6;font-size:15.5px;max-width:540px}
    .box{background:#f1f3f6;border-radius:14px;padding:18px 20px;text-align:left;margin:0 auto 28px;max-width:540px}
    .row{display:flex;justify-content:space-between;font-size:15px;margin:6px 0}
    .row b{color:#000}
    .hint{font-size:13px;color:var(--muted);margin-top:8px}
    .btns{display:grid;gap:14px;margin:0 auto;max-width:540px}
    .btn{
      display:inline-flex;justify-content:center;align-items:center;
      padding:14px 18px;border-radius:12px;font-weight:600;font-size:16px;text-decoration:none;
      color:#fff;transition:all .2s ease;
    }
    .btn.pay{background:var(--primary)} .btn.pay:hover{background:var(--primary-hover);transform:translateY(-1px)}
    .btn.deposit{background:var(--success)} .btn.deposit:hover{background:var(--success-hover);transform:translateY(-1px)}
    footer{margin-top:28px;font-size:13px;color:var(--muted)}
    @media (min-width:720px){.btns{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="langswitch">
        <button id="btn-it">IT</button>
        <button id="btn-en">EN</button>
      </div>

      <img src="/logo2.svg?v=3" alt="I Bimbi logo" class="logo" />

      <h1 data-i18n="title">Parcheggio & Deposito</h1>

      <p class="lead" data-i18n="lead">
        Il costo del parcheggio √® di <b>25 ‚Ç¨ al giorno</b>.<br><br>
        Al momento della prenotazione ti chiediamo di effettuare il <b>pagamento anticipato dei giorni desiderati</b>.
        Se la tua sosta √® di pi√π giorni, potrai <b>selezionare il numero di giornate direttamente in fase di pagamento</b>.<br><br>
        Inoltre, <b>3 giorni prima dell‚Äôarrivo</b> ti verr√† richiesto di <b>autorizzare un deposito di 50 ‚Ç¨</b> a garanzia della chiave del garage.
        Il deposito non viene addebitato ma solo ‚Äúbloccato‚Äù sulla carta e <b>rilasciato automaticamente dopo il check-out</b>, salvo smarrimento della scheda di accesso.<br><br>
        ‚ö†Ô∏è La prenotazione del parcheggio sar√† considerata <b>confermata solo dopo il completamento del pagamento e dell‚Äôautorizzazione del deposito</b>.
      </p>

      <div class="box">
        <div class="row"><span data-i18n="parking">Pagamento prenotazione parcheggio</span><b>‚Ç¨ 25,00 / giorno</b></div>
        <div class="row"><span data-i18n="deposit">Deposito (pre-autorizzazione 3 giorni prima dell‚Äôarrivo)</span><b>‚Ç¨ 50,00</b></div>
        <div id="info" class="hint" data-i18n="hint">
          
        </div>
      </div>

      <div class="btns">
        <a id="payLink" class="btn pay"
           href="https://buy.stripe.com/8x214n0Oi9wp5pR7wP7Zu09" target="_blank" rel="noopener" data-i18n="btnPay">
          üí≥ Paga e conferma prenotazione (25 ‚Ç¨/giorno)
        </a>

        <a id="depositLink" class="btn deposit"
           href="https://bar.ibimbiapartments.it/.netlify/functions/deposit" target="_blank" rel="noopener" data-i18n="btnDeposit">
          üîí Autorizza deposito (50 ‚Ç¨)
        </a>
      </div>

      <footer data-i18n="foot">Pagamenti sicuri con Stripe ¬∑ 3D Secure automatico</footer>
    </div>
  </div>

  <script>
    const I18N = {
      it: {
        title: "Parcheggio & Deposito",
        lead: `Il costo del parcheggio √® di <b>25 ‚Ç¨ al giorno</b>.<br><br>
               Al momento della prenotazione ti chiediamo di effettuare il <b>pagamento anticipato dei giorni desiderati</b>.
               Se la tua sosta √® di pi√π giorni, potrai <b>selezionare il numero di giornate direttamente in fase di pagamento</b>.<br><br>
               Inoltre, <b>3 giorni prima dell‚Äôarrivo</b> ti verr√† richiesto di <b>autorizzare un deposito di 50 ‚Ç¨</b> a garanzia della chiave del garage.
               Il deposito non viene addebitato ma solo ‚Äúbloccato‚Äù sulla carta e <b>rilasciato automaticamente dopo il check-out</b>, salvo smarrimento della scheda di accesso.<br><br>
               ‚ö†Ô∏è La prenotazione del parcheggio sar√† considerata <b>confermata solo dopo il completamento del pagamento e dell‚Äôautorizzazione del deposito</b>.`,
        parking: "Pagamento prenotazione parcheggio",
        deposit: "Deposito (pre-autorizzazione 3 giorni prima dell‚Äôarrivo)",
        hint: "Aprendo da un link personalizzato, la stanza e l‚Äôospite verranno associati automaticamente.",
        btnPay: "üí≥ Paga e conferma prenotazione (25 ‚Ç¨/giorno)",
        btnDeposit: "üîí Autorizza deposito (50 ‚Ç¨)",
        foot: "Pagamenti sicuri con Stripe ¬∑ 3D Secure automatico"
      },
      en: {
        title: "Parking & Deposit",
        lead: `The parking rate is <b>‚Ç¨25 per day</b>.<br><br>
               At the time of booking, please <b>prepay for the desired number of days</b>.
               If your stay covers multiple days, you can <b>select the number of days directly during checkout</b>.<br><br>
               In addition, <b>3 days before arrival</b>, you‚Äôll be asked to <b>authorize a ‚Ç¨50 deposit</b> as a guarantee for the garage key.
               This amount is not charged, but temporarily held on your card and <b>automatically released after check-out</b>, unless the access card is lost.<br><br>
               ‚ö†Ô∏è Your parking reservation will be considered <b>confirmed only once both the payment and the deposit authorization have been completed</b>.`,
        parking: "Parking reservation payment",
        deposit: "Deposit (pre-authorization 3 days before arrival)",
        hint: "",
        btnPay: "üí≥ Pay and confirm reservation (‚Ç¨25/day)",
        btnDeposit: "üîí Authorize deposit (‚Ç¨50)",
        foot: "Secure payments with Stripe ¬∑ 3D Secure enabled"
      }
    };

    const u = new URL(window.location.href);
    const room=u.searchParams.get('room')||'';
    const guest=u.searchParams.get('guest')||'';
    const amount=u.searchParams.get('amount')||'25';
    let lang=(u.searchParams.get('lang')||'').toLowerCase();
    if(!lang){lang=(navigator.language||'en').toLowerCase().startsWith('it')?'it':'en';}

    function setLang(l){
      const dict=I18N[l]||I18N.en;
      document.documentElement.lang=l;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key=el.getAttribute('data-i18n');
        if(dict[key]){
          if(dict[key].includes('<b>')||dict[key].includes('<br')) el.innerHTML=dict[key];
          else el.textContent=dict[key];
        }
      });
      document.getElementById('btn-it').classList.toggle('active',l==='it');
      document.getElementById('btn-en').classList.toggle('active',l==='en');
    }

    (function(){
      const base='https://bar.ibimbiapartments.it/.netlify/functions/deposit';
      const q=new URLSearchParams();
      if(amount)q.set('amount',amount);
      if(room)q.set('room',room);
      if(guest)q.set('guest',guest);
      document.getElementById('depositLink').href=`${base}?${q}`;
      const info=document.getElementById('info');
      if(room||guest){
        info.textContent=(lang==='it')
          ? `Autorizzazione associata a: ${room?`Stanza ${room}`:''}${room&&guest?' ‚Ä¢ ':''}${guest||''}.`
          : `Authorization linked to: ${room?`Room ${room}`:''}${room&&guest?' ‚Ä¢ ':''}${guest||''}.`;
      }
    })();

    setLang(lang);
    document.getElementById('btn-it').onclick=()=>{setLang('it');history.replaceState(null,'',updateQS('lang','it'));};
    document.getElementById('btn-en').onclick=()=>{setLang('en');history.replaceState(null,'',updateQS('lang','en'));};
    function updateQS(key,val){const url=new URL(window.location.href);url.searchParams.set(key,val);return url.toString();}
  </script>
</body>
</html>
